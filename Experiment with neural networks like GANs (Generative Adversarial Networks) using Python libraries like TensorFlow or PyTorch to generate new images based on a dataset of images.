import tensorflow as tf
from tensorflow.keras import layers
import matplotlib.pyplot as plt
import numpy as np

# generator
generator = tf.keras.Sequential([
    layers.Dense(128, input_shape=(100,)),
    layers.LeakyReLU(),
    layers.Dense(28*28, activation="tanh"),
    layers.Reshape((28, 28))
])

# discriminator
discriminator = tf.keras.Sequential([
    layers.Flatten(input_shape=(28, 28)),
    layers.Dense(128),
    layers.LeakyReLU(),
    layers.Dense(1, activation="sigmoid")
])

print("Generator summary:")
generator.summary()

print("\nDiscriminator summary:")
discriminator.summary()

# generate fake image
noise = tf.random.normal([1, 100])
fake_image = generator(noise)

# display generated image
plt.imshow(fake_image[0], cmap="gray")
plt.title("Generated Image")
plt.axis("off")
plt.show()
